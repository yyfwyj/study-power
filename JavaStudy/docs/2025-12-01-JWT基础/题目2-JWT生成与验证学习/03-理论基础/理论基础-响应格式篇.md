# ç†è®ºåŸºç¡€ï¼šç»Ÿä¸€å“åº”æ ¼å¼è®¾è®¡

## ğŸ“– ç›®å½•

- [1. ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€å“åº”æ ¼å¼](#1-ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€å“åº”æ ¼å¼)
- [2. RESTful APIå“åº”æ ‡å‡†](#2-restful-apiå“åº”æ ‡å‡†)
- [3. HTTPçŠ¶æ€ç è§„èŒƒ](#3-httpçŠ¶æ€ç è§„èŒƒ)
- [4. ä¸šåŠ¡çŠ¶æ€ç è®¾è®¡](#4-ä¸šåŠ¡çŠ¶æ€ç è®¾è®¡)
- [5. ä¼ä¸šçº§å“åº”æ ¼å¼è®¾è®¡](#5-ä¼ä¸šçº§å“åº”æ ¼å¼è®¾è®¡)

---

## 1. ä¸ºä»€ä¹ˆéœ€è¦ç»Ÿä¸€å“åº”æ ¼å¼

### 1.1 æ²¡æœ‰ç»Ÿä¸€æ ¼å¼çš„é—®é¢˜

**é—®é¢˜åœºæ™¯**ï¼š

ä¸åŒçš„æ¥å£è¿”å›æ ¼å¼ä¸åŒï¼š

```java
// æ¥å£1ï¼šè¿”å›ç®€å•å­—ç¬¦ä¸²
@GetMapping("/user1")
public String getUser1() {
    return "success";
}

// æ¥å£2ï¼šè¿”å›Map
@GetMapping("/user2")
public Map<String, Object> getUser2() {
    Map<String, Object> result = new HashMap<>();
    result.put("code", 200);
    result.put("data", user);
    return result;
}

// æ¥å£3ï¼šè¿”å›å¯¹è±¡
@GetMapping("/user3")
public User getUser3() {
    return user;
}

// æ¥å£4ï¼šå¼‚å¸¸æ—¶è¿”å›å­—ç¬¦ä¸²
@GetMapping("/user4")
public String getUser4() {
    if (error) {
        return "error: ç”¨æˆ·ä¸å­˜åœ¨";
    }
    return user;
}
```

**å¸¦æ¥çš„é—®é¢˜**ï¼š

- âŒ å‰ç«¯éš¾ä»¥ç»Ÿä¸€å¤„ç†å“åº”
- âŒ é”™è¯¯ä¿¡æ¯æ ¼å¼ä¸ç»Ÿä¸€
- âŒ æ— æ³•åŒºåˆ†ä¸šåŠ¡é”™è¯¯å’Œç³»ç»Ÿé”™è¯¯
- âŒ ä¸åˆ©äºAPIæ–‡æ¡£ç»´æŠ¤
- âŒ è°ƒè¯•å›°éš¾

### 1.2 ç»Ÿä¸€å“åº”æ ¼å¼çš„ä¼˜åŠ¿

**ç»Ÿä¸€çš„å“åº”æ ¼å¼**ï¼š

```json
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        "id": 1,
        "username": "admin"
    },
    "timestamp": "2025-12-02T10:00:00"
}
```

**ä¼˜åŠ¿**ï¼š

- âœ… å‰ç«¯å¯ä»¥ç»Ÿä¸€å¤„ç†å“åº”
- âœ… é”™è¯¯ä¿¡æ¯æ ¼å¼ä¸€è‡´
- âœ… æ˜“äºç»´æŠ¤å’Œæ‰©å±•
- âœ… ä¾¿äºAPIæ–‡æ¡£ç¼–å†™
- âœ… æé«˜å¼€å‘æ•ˆç‡

---

## 2. RESTful APIå“åº”æ ‡å‡†

### 2.1 RESTfulåŸåˆ™

**RESTful APIçš„æ ¸å¿ƒåŸåˆ™**ï¼š

1. **ä½¿ç”¨HTTPåŠ¨è¯**ï¼šGETã€POSTã€PUTã€DELETEç­‰
2. **ä½¿ç”¨HTTPçŠ¶æ€ç **ï¼š200ã€400ã€401ã€404ã€500ç­‰
3. **ä½¿ç”¨èµ„æºåè¯**ï¼š/usersã€/ordersç­‰
4. **æ— çŠ¶æ€**ï¼šæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„

### 2.2 æ ‡å‡†å“åº”ç»“æ„

**æˆåŠŸå“åº”**ï¼š

```json
{
    "code": 200,
    "message": "success",
    "data": { /* ä¸šåŠ¡æ•°æ® */ }
}
```

**é”™è¯¯å“åº”**ï¼š

```json
{
    "code": 400,
    "message": "å‚æ•°é”™è¯¯",
    "data": null
}
```

**æ ‡å‡†å­—æ®µ**ï¼š

- `code`ï¼šçŠ¶æ€ç ï¼ˆHTTPçŠ¶æ€ç æˆ–ä¸šåŠ¡çŠ¶æ€ç ï¼‰
- `message`ï¼šæ¶ˆæ¯æè¿°
- `data`ï¼šä¸šåŠ¡æ•°æ®ï¼ˆæˆåŠŸæ—¶åŒ…å«ï¼Œå¤±è´¥æ—¶é€šå¸¸ä¸ºnullï¼‰

---

## 3. HTTPçŠ¶æ€ç è§„èŒƒ

### 3.1 HTTPçŠ¶æ€ç åˆ†ç±»

**1xx - ä¿¡æ¯æ€§çŠ¶æ€ç **ï¼š
- 100 Continueï¼šç»§ç»­å‘é€è¯·æ±‚ä½“
- 101 Switching Protocolsï¼šåˆ‡æ¢åè®®

**2xx - æˆåŠŸçŠ¶æ€ç **ï¼š
- **200 OK**ï¼šè¯·æ±‚æˆåŠŸï¼ˆæœ€å¸¸ç”¨ï¼‰
- 201 Createdï¼šèµ„æºåˆ›å»ºæˆåŠŸ
- 204 No Contentï¼šæˆåŠŸä½†æ— è¿”å›å†…å®¹

**3xx - é‡å®šå‘çŠ¶æ€ç **ï¼š
- 301 Moved Permanentlyï¼šæ°¸ä¹…é‡å®šå‘
- 302 Foundï¼šä¸´æ—¶é‡å®šå‘

**4xx - å®¢æˆ·ç«¯é”™è¯¯**ï¼š
- **400 Bad Request**ï¼šè¯·æ±‚å‚æ•°é”™è¯¯
- **401 Unauthorized**ï¼šæœªè®¤è¯ï¼ˆéœ€è¦ç™»å½•ï¼‰
- **403 Forbidden**ï¼šæ— æƒé™ï¼ˆå·²ç™»å½•ä½†æ— æƒé™ï¼‰
- **404 Not Found**ï¼šèµ„æºä¸å­˜åœ¨
- 409 Conflictï¼šèµ„æºå†²çª

**5xx - æœåŠ¡å™¨é”™è¯¯**ï¼š
- **500 Internal Server Error**ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- 502 Bad Gatewayï¼šç½‘å…³é”™è¯¯
- 503 Service Unavailableï¼šæœåŠ¡ä¸å¯ç”¨

### 3.2 JWTåœºæ™¯ä¸­çš„çŠ¶æ€ç ä½¿ç”¨

**401 Unauthorizedï¼ˆæœªè®¤è¯ï¼‰**ï¼š

```json
HTTP/1.1 401 Unauthorized
Content-Type: application/json

{
    "code": 401,
    "message": "æœªç™»å½•æˆ–Tokenå·²è¿‡æœŸ",
    "data": null
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- æœªæä¾›Token
- Tokenæ— æ•ˆ
- Tokenå·²è¿‡æœŸ
- Tokenæ ¼å¼é”™è¯¯

**403 Forbiddenï¼ˆæ— æƒé™ï¼‰**ï¼š

```json
HTTP/1.1 403 Forbidden
Content-Type: application/json

{
    "code": 403,
    "message": "æ— æƒè®¿é—®è¯¥èµ„æº",
    "data": null
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å·²ç™»å½•ä½†æ— æƒé™è®¿é—®
- è§’è‰²æƒé™ä¸è¶³

**400 Bad Requestï¼ˆè¯·æ±‚é”™è¯¯ï¼‰**ï¼š

```json
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "code": 400,
    "message": "è¯·æ±‚å‚æ•°é”™è¯¯ï¼šç”¨æˆ·åä¸èƒ½ä¸ºç©º",
    "data": null
}
```

**ä½¿ç”¨åœºæ™¯**ï¼š
- å‚æ•°éªŒè¯å¤±è´¥
- å‚æ•°æ ¼å¼é”™è¯¯

### 3.3 çŠ¶æ€ç é€‰æ‹©åŸåˆ™

**åŸåˆ™**ï¼š

1. **2xx = æˆåŠŸ**ï¼šè¯·æ±‚è¢«æˆåŠŸå¤„ç†
2. **4xx = å®¢æˆ·ç«¯é”™è¯¯**ï¼šè¯·æ±‚æœ‰é—®é¢˜ï¼ˆå‚æ•°ã€è®¤è¯ã€æƒé™ï¼‰
3. **5xx = æœåŠ¡å™¨é”™è¯¯**ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯

**å¸¸è§é”™è¯¯**ï¼š

- âŒ ç”¨200è¡¨ç¤ºä¸šåŠ¡å¤±è´¥ï¼ˆåº”è¯¥ç”¨400æˆ–ä¸šåŠ¡çŠ¶æ€ç ï¼‰
- âŒ ç”¨500è¡¨ç¤ºå‚æ•°é”™è¯¯ï¼ˆåº”è¯¥ç”¨400ï¼‰
- âŒ ç”¨404è¡¨ç¤ºæ— æƒé™ï¼ˆåº”è¯¥ç”¨403ï¼‰

---

## 4. ä¸šåŠ¡çŠ¶æ€ç è®¾è®¡

### 4.1 ä¸ºä»€ä¹ˆéœ€è¦ä¸šåŠ¡çŠ¶æ€ç 

**HTTPçŠ¶æ€ç çš„å±€é™æ€§**ï¼š

- HTTPçŠ¶æ€ç ä¸»è¦ç”¨äºHTTPåè®®å±‚é¢
- ä¸šåŠ¡å±‚é¢çš„é”™è¯¯éœ€è¦æ›´ç»†ç²’åº¦çš„çŠ¶æ€ç 
- ä¾‹å¦‚ï¼šåŒä¸€ä¸ª400é”™è¯¯ï¼Œå¯èƒ½æ˜¯ç”¨æˆ·åé”™è¯¯ã€å¯†ç é”™è¯¯ã€éªŒè¯ç é”™è¯¯ç­‰

**ä¸šåŠ¡çŠ¶æ€ç çš„ä¼˜åŠ¿**ï¼š

- âœ… æ›´ç»†ç²’åº¦çš„é”™è¯¯åˆ†ç±»
- âœ… å‰ç«¯å¯ä»¥æ ¹æ®ä¸šåŠ¡çŠ¶æ€ç åšä¸åŒå¤„ç†
- âœ… ä¾¿äºé”™è¯¯ç»Ÿè®¡å’Œåˆ†æ
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

### 4.2 ä¸šåŠ¡çŠ¶æ€ç è®¾è®¡åŸåˆ™

**è®¾è®¡åŸåˆ™**ï¼š

1. **åˆ†æ®µè®¾è®¡**ï¼š
   - 1xxxï¼šé€šç”¨é”™è¯¯
   - 2xxxï¼šè®¤è¯ç›¸å…³é”™è¯¯
   - 3xxxï¼šæˆæƒç›¸å…³é”™è¯¯
   - 4xxxï¼šä¸šåŠ¡ç›¸å…³é”™è¯¯

2. **æ˜“äºè®°å¿†**ï¼š
   - 2001ï¼šç™»å½•å¤±è´¥
   - 2002ï¼šTokenè¿‡æœŸ
   - 3001ï¼šæ— æƒé™è®¿é—®

3. **å¯æ‰©å±•**ï¼š
   - é¢„ç•™è¶³å¤Ÿçš„ç æ®µ
   - ä¾¿äºåç»­æ‰©å±•

### 4.3 ä¸šåŠ¡çŠ¶æ€ç ç¤ºä¾‹

**å¸¸ç”¨ä¸šåŠ¡çŠ¶æ€ç **ï¼š

```java
public enum BusinessCode {
    // æˆåŠŸ
    SUCCESS(200, "æ“ä½œæˆåŠŸ"),
    
    // é€šç”¨é”™è¯¯ 1xxx
    PARAM_ERROR(1001, "å‚æ•°é”™è¯¯"),
    DATA_NOT_FOUND(1002, "æ•°æ®ä¸å­˜åœ¨"),
    
    // è®¤è¯é”™è¯¯ 2xxx
    NOT_LOGIN(2001, "æœªç™»å½•"),
    TOKEN_EXPIRED(2002, "Tokenå·²è¿‡æœŸ"),
    TOKEN_INVALID(2003, "Tokenæ— æ•ˆ"),
    LOGIN_FAILED(2004, "ç™»å½•å¤±è´¥ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"),
    
    // æˆæƒé”™è¯¯ 3xxx
    NO_PERMISSION(3001, "æ— æƒè®¿é—®è¯¥èµ„æº"),
    ROLE_NOT_ALLOWED(3002, "è§’è‰²æƒé™ä¸è¶³"),
    
    // ä¸šåŠ¡é”™è¯¯ 4xxx
    USER_NOT_FOUND(4001, "ç”¨æˆ·ä¸å­˜åœ¨"),
    USER_ALREADY_EXISTS(4002, "ç”¨æˆ·å·²å­˜åœ¨");
    
    private final int code;
    private final String message;
    
    BusinessCode(int code, String message) {
        this.code = code;
        this.message = message;
    }
    
    // getteræ–¹æ³•...
}
```

---

## 5. ä¼ä¸šçº§å“åº”æ ¼å¼è®¾è®¡

### 5.1 æ ‡å‡†å“åº”ç±»è®¾è®¡

**åŸºç¡€å“åº”ç±»**ï¼š

```java
public class Result<T> {
    private Integer code;        // çŠ¶æ€ç 
    private String message;      // æ¶ˆæ¯
    private T data;              // æ•°æ®
    private Long timestamp;      // æ—¶é—´æˆ³
    
    // æ„é€ å‡½æ•°ã€getterã€setter...
}
```

**é™æ€å·¥å‚æ–¹æ³•**ï¼š

```java
// æˆåŠŸå“åº”
public static <T> Result<T> success(T data) {
    return new Result<>(200, "success", data, System.currentTimeMillis());
}

// å¤±è´¥å“åº”
public static <T> Result<T> fail(Integer code, String message) {
    return new Result<>(code, message, null, System.currentTimeMillis());
}
```

### 5.2 ç»Ÿä¸€å¼‚å¸¸å¤„ç†

**ä½¿ç”¨@ControllerAdvice**ï¼š

```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(AuthenticationException.class)
    public ResponseEntity<Result<Void>> handleAuthException(AuthenticationException e) {
        return ResponseEntity
            .status(HttpStatus.UNAUTHORIZED)
            .body(Result.fail(2001, "æœªç™»å½•"));
    }
    
    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<Result<Void>> handleParamException(IllegalArgumentException e) {
        return ResponseEntity
            .status(HttpStatus.BAD_REQUEST)
            .body(Result.fail(1001, e.getMessage()));
    }
}
```

### 5.3 å®Œæ•´å“åº”æ ¼å¼ç¤ºä¾‹

**æˆåŠŸå“åº”**ï¼š

```json
{
    "code": 200,
    "message": "success",
    "data": {
        "id": 1,
        "username": "admin"
    },
    "timestamp": 1701590400000
}
```

**é”™è¯¯å“åº”**ï¼š

```json
{
    "code": 401,
    "message": "æœªç™»å½•æˆ–Tokenå·²è¿‡æœŸ",
    "data": null,
    "timestamp": 1701590400000
}
```

---

## ğŸ“ æ€»ç»“

### å…³é”®è¦ç‚¹

1. **ç»Ÿä¸€å“åº”æ ¼å¼**ï¼šæé«˜å¼€å‘æ•ˆç‡ï¼Œä¾¿äºç»´æŠ¤
2. **HTTPçŠ¶æ€ç **ï¼šç”¨äºHTTPåè®®å±‚é¢çš„çŠ¶æ€è¡¨ç¤º
3. **ä¸šåŠ¡çŠ¶æ€ç **ï¼šç”¨äºä¸šåŠ¡å±‚é¢çš„ç»†ç²’åº¦é”™è¯¯åˆ†ç±»
4. **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**ï¼šä½¿ç”¨@ControllerAdviceç»Ÿä¸€å¤„ç†å¼‚å¸¸

### è®¾è®¡åŸåˆ™

- âœ… ç»Ÿä¸€æ€§ï¼šæ‰€æœ‰æ¥å£ä½¿ç”¨ç›¸åŒçš„å“åº”æ ¼å¼
- âœ… å¯æ‰©å±•æ€§ï¼šä¾¿äºåç»­æ·»åŠ å­—æ®µ
- âœ… å¯è¯»æ€§ï¼šå­—æ®µå‘½åæ¸…æ™°ï¼Œæ˜“äºç†è§£
- âœ… æ ‡å‡†åŒ–ï¼šéµå¾ªRESTfulè§„èŒƒ

### ä¸‹ä¸€æ­¥å­¦ä¹ 

ç†è§£å“åº”æ ¼å¼è®¾è®¡åï¼Œæ¥ä¸‹æ¥åº”è¯¥å­¦ä¹ ï¼š

- [APIè¯¦è§£-å“åº”æ ¼å¼ç¯‡](../02-APIè¯¦è§£/APIè¯¦è§£-å“åº”æ ¼å¼ç¯‡.md) - æŒæ¡å…·ä½“çš„APIä½¿ç”¨æ–¹æ³•
- [å®Œæ•´å­¦ä¹ æŒ‡å—](../01-å­¦ä¹ æŒ‡å—/å®Œæ•´å­¦ä¹ æŒ‡å—.md) - å¼€å§‹åŠ¨æ‰‹å®ç°

---

*æ–‡æ¡£æ›´æ–°æ—¶é—´ï¼š2025å¹´12æœˆ2æ—¥*
